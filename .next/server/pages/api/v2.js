"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/v2";
exports.ids = ["pages/api/v2"];
exports.modules = {

/***/ "(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fv2&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fv2.ts&middlewareConfigBase64=e30%3D!":
/*!**********************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fv2&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fv2.ts&middlewareConfigBase64=e30%3D! ***!
  \**********************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/pages-api/module.compiled */ \"(api-node)/./node_modules/next/dist/server/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(api-node)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api-node)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_v2_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages/api/v2.ts */ \"(api-node)/./pages/api/v2.ts\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_v2_ts__WEBPACK_IMPORTED_MODULE_3__, 'default'));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_v2_ts__WEBPACK_IMPORTED_MODULE_3__, 'config');\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/v2\",\n        pathname: \"/api/v2\",\n        // The following aren't used in production.\n        bundlePath: '',\n        filename: ''\n    },\n    userland: _pages_api_v2_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL25vZGVfbW9kdWxlcy9uZXh0L2Rpc3QvYnVpbGQvd2VicGFjay9sb2FkZXJzL25leHQtcm91dGUtbG9hZGVyL2luZGV4LmpzP2tpbmQ9UEFHRVNfQVBJJnBhZ2U9JTJGYXBpJTJGdjImcHJlZmVycmVkUmVnaW9uPSZhYnNvbHV0ZVBhZ2VQYXRoPS4lMkZwYWdlcyUyRmFwaSUyRnYyLnRzJm1pZGRsZXdhcmVDb25maWdCYXNlNjQ9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUErRjtBQUN2QztBQUNFO0FBQzFEO0FBQzhDO0FBQzlDO0FBQ0EsaUVBQWUsd0VBQUssQ0FBQyw2Q0FBUSxZQUFZLEVBQUM7QUFDMUM7QUFDTyxlQUFlLHdFQUFLLENBQUMsNkNBQVE7QUFDcEM7QUFDTyx3QkFBd0IseUdBQW1CO0FBQ2xEO0FBQ0EsY0FBYyxrRUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVk7QUFDWixDQUFDOztBQUVEIiwic291cmNlcyI6WyIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUGFnZXNBUElSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3JvdXRlLW1vZHVsZXMvcGFnZXMtYXBpL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgaG9pc3QgfSBmcm9tIFwibmV4dC9kaXN0L2J1aWxkL3RlbXBsYXRlcy9oZWxwZXJzXCI7XG4vLyBJbXBvcnQgdGhlIHVzZXJsYW5kIGNvZGUuXG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiLi9wYWdlcy9hcGkvdjIudHNcIjtcbi8vIFJlLWV4cG9ydCB0aGUgaGFuZGxlciAoc2hvdWxkIGJlIHRoZSBkZWZhdWx0IGV4cG9ydCkuXG5leHBvcnQgZGVmYXVsdCBob2lzdCh1c2VybGFuZCwgJ2RlZmF1bHQnKTtcbi8vIFJlLWV4cG9ydCBjb25maWcuXG5leHBvcnQgY29uc3QgY29uZmlnID0gaG9pc3QodXNlcmxhbmQsICdjb25maWcnKTtcbi8vIENyZWF0ZSBhbmQgZXhwb3J0IHRoZSByb3V0ZSBtb2R1bGUgdGhhdCB3aWxsIGJlIGNvbnN1bWVkLlxuZXhwb3J0IGNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IFBhZ2VzQVBJUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLlBBR0VTX0FQSSxcbiAgICAgICAgcGFnZTogXCIvYXBpL3YyXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvdjJcIixcbiAgICAgICAgLy8gVGhlIGZvbGxvd2luZyBhcmVuJ3QgdXNlZCBpbiBwcm9kdWN0aW9uLlxuICAgICAgICBidW5kbGVQYXRoOiAnJyxcbiAgICAgICAgZmlsZW5hbWU6ICcnXG4gICAgfSxcbiAgICB1c2VybGFuZFxufSk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBhZ2VzLWFwaS5qcy5tYXAiXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fv2&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fv2.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api-node)/./pages/api/v2.ts":
/*!*************************!*\
  !*** ./pages/api/v2.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* export default binding */ __WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\nconst OpenAi = __webpack_require__(/*! openai */ \"openai\");\n(__webpack_require__(/*! dotenv */ \"dotenv\").config)();\nconst client = new OpenAi({\n    apiKey: process.env.OPENAI_API_KEY,\n    baseURL: 'https://api.chatanywhere.tech/v1'\n});\nconst getV2 = async (message, res)=>{\n    try {\n        const stream = await client.chat.completions.create({\n            messages: [\n                {\n                    role: 'user',\n                    content: message\n                }\n            ],\n            model: 'gpt-3.5-turbo',\n            stream: true\n        });\n        for await (const part of stream){\n            // if (res.finished) break; // 检查客户端是否已断开连接\n            const eventName = 'message';\n            console.log(part.choices[0].delta.content);\n            if (part.choices[0].delta && part.choices[0].delta.content) {\n                res.write(`event: ${eventName}\\n`);\n                res.write(`data: ${part.choices[0].delta.content}\\n\\n`);\n            }\n        }\n        res.end(); // 结束连接\n    } catch (error) {\n        console.error('Error during OpenAI API call:', error);\n        res.end(); // 结束连接\n    }\n};\n/* harmony default export */ async function __WEBPACK_DEFAULT_EXPORT__(req, res) {\n    const { message } = req.query;\n    // 设置适当的头信息\n    res.setHeader('Content-Type', 'text/event-stream;charset=utf-8');\n    res.setHeader('Access-Control-Allow-Origin', '*');\n    res.setHeader('X-Accel-Buffering', 'no');\n    res.setHeader('Cache-Control', 'no-cache, no-transform');\n    getV2(message, res);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL3BhZ2VzL2FwaS92Mi50cyIsIm1hcHBpbmdzIjoiOzs7O0FBQUEsTUFBTUEsU0FBU0MsbUJBQU9BLENBQUMsc0JBQVE7QUFDL0JBLG9EQUF3QjtBQUV4QixNQUFNRSxTQUFTLElBQUlILE9BQU87SUFDdEJJLFFBQVFDLFFBQVFDLEdBQUcsQ0FBQ0MsY0FBYztJQUNsQ0MsU0FBUztBQUNiO0FBRUEsTUFBTUMsUUFBUSxPQUFPQyxTQUFTQztJQUMxQixJQUFJO1FBQ0EsTUFBTUMsU0FBUyxNQUFNVCxPQUFPVSxJQUFJLENBQUNDLFdBQVcsQ0FBQ0MsTUFBTSxDQUFDO1lBQ2hEQyxVQUFVO2dCQUFDO29CQUFFQyxNQUFNO29CQUFRQyxTQUFTUjtnQkFBUTthQUFFO1lBQzlDUyxPQUFPO1lBQ1BQLFFBQVE7UUFDWjtRQUVBLFdBQVcsTUFBTVEsUUFBUVIsT0FBUTtZQUM3QiwyQ0FBMkM7WUFDM0MsTUFBTVMsWUFBWTtZQUNsQkMsUUFBUUMsR0FBRyxDQUFDSCxLQUFLSSxPQUFPLENBQUMsRUFBRSxDQUFDQyxLQUFLLENBQUNQLE9BQU87WUFDekMsSUFBSUUsS0FBS0ksT0FBTyxDQUFDLEVBQUUsQ0FBQ0MsS0FBSyxJQUFJTCxLQUFLSSxPQUFPLENBQUMsRUFBRSxDQUFDQyxLQUFLLENBQUNQLE9BQU8sRUFBRTtnQkFDMURQLElBQUllLEtBQUssQ0FBQyxDQUFDLE9BQU8sRUFBRUwsVUFBVSxFQUFFLENBQUM7Z0JBQ2pDVixJQUFJZSxLQUFLLENBQUMsQ0FBQyxNQUFNLEVBQUVOLEtBQUtJLE9BQU8sQ0FBQyxFQUFFLENBQUNDLEtBQUssQ0FBQ1AsT0FBTyxDQUFDLElBQUksQ0FBQztZQUN4RDtRQUNKO1FBQ0FQLElBQUlnQixHQUFHLElBQUksT0FBTztJQUN0QixFQUFFLE9BQU9DLE9BQU87UUFDWk4sUUFBUU0sS0FBSyxDQUFDLGlDQUFpQ0E7UUFDL0NqQixJQUFJZ0IsR0FBRyxJQUFJLE9BQU87SUFDdEI7QUFDSjtBQUVBLDZCQUFlLDBDQUFnQkUsR0FBRyxFQUFFbEIsR0FBRztJQUNuQyxNQUFNLEVBQUVELE9BQU8sRUFBRSxHQUFHbUIsSUFBSUMsS0FBSztJQUU3QixXQUFXO0lBQ1huQixJQUFJb0IsU0FBUyxDQUFDLGdCQUFnQjtJQUM5QnBCLElBQUlvQixTQUFTLENBQUMsK0JBQStCO0lBQzdDcEIsSUFBSW9CLFNBQVMsQ0FBQyxxQkFBcUI7SUFDbkNwQixJQUFJb0IsU0FBUyxDQUFDLGlCQUFpQjtJQUUvQnRCLE1BQU1DLFNBQVNDO0FBQ25CIiwic291cmNlcyI6WyIvVXNlcnMveHVoZXhpbi9XZWJzdG9ybVByb2plY3RzL015Q29kZS94aW5BaS9wYWdlcy9hcGkvdjIudHMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgT3BlbkFpID0gcmVxdWlyZSgnb3BlbmFpJyk7XG5yZXF1aXJlKCdkb3RlbnYnKS5jb25maWcoKTtcblxuY29uc3QgY2xpZW50ID0gbmV3IE9wZW5BaSh7XG4gICAgYXBpS2V5OiBwcm9jZXNzLmVudi5PUEVOQUlfQVBJX0tFWSwgLy8g5L2/55So546v5aKD5Y+Y6YeP5Yqg6L29IEFQSSDlr4bpkqVcbiAgICBiYXNlVVJMOiAnaHR0cHM6Ly9hcGkuY2hhdGFueXdoZXJlLnRlY2gvdjEnLFxufSk7XG5cbmNvbnN0IGdldFYyID0gYXN5bmMgKG1lc3NhZ2UsIHJlcykgPT4ge1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHN0cmVhbSA9IGF3YWl0IGNsaWVudC5jaGF0LmNvbXBsZXRpb25zLmNyZWF0ZSh7XG4gICAgICAgICAgICBtZXNzYWdlczogW3sgcm9sZTogJ3VzZXInLCBjb250ZW50OiBtZXNzYWdlIH1dLFxuICAgICAgICAgICAgbW9kZWw6ICdncHQtMy41LXR1cmJvJyxcbiAgICAgICAgICAgIHN0cmVhbTogdHJ1ZSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgZm9yIGF3YWl0IChjb25zdCBwYXJ0IG9mIHN0cmVhbSkge1xuICAgICAgICAgICAgLy8gaWYgKHJlcy5maW5pc2hlZCkgYnJlYWs7IC8vIOajgOafpeWuouaIt+err+aYr+WQpuW3suaWreW8gOi/nuaOpVxuICAgICAgICAgICAgY29uc3QgZXZlbnROYW1lID0gJ21lc3NhZ2UnO1xuICAgICAgICAgICAgY29uc29sZS5sb2cocGFydC5jaG9pY2VzWzBdLmRlbHRhLmNvbnRlbnQpO1xuICAgICAgICAgICAgaWYgKHBhcnQuY2hvaWNlc1swXS5kZWx0YSAmJiBwYXJ0LmNob2ljZXNbMF0uZGVsdGEuY29udGVudCkge1xuICAgICAgICAgICAgICByZXMud3JpdGUoYGV2ZW50OiAke2V2ZW50TmFtZX1cXG5gKTtcbiAgICAgICAgICAgICAgcmVzLndyaXRlKGBkYXRhOiAke3BhcnQuY2hvaWNlc1swXS5kZWx0YS5jb250ZW50fVxcblxcbmApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJlcy5lbmQoKTsgLy8g57uT5p2f6L+e5o6lXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZHVyaW5nIE9wZW5BSSBBUEkgY2FsbDonLCBlcnJvcik7XG4gICAgICAgIHJlcy5lbmQoKTsgLy8g57uT5p2f6L+e5o6lXG4gICAgfVxufTtcblxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gKHJlcSwgcmVzKSB7XG4gICAgY29uc3QgeyBtZXNzYWdlIH0gPSByZXEucXVlcnk7XG5cbiAgICAvLyDorr7nva7pgILlvZPnmoTlpLTkv6Hmga9cbiAgICByZXMuc2V0SGVhZGVyKCdDb250ZW50LVR5cGUnLCAndGV4dC9ldmVudC1zdHJlYW07Y2hhcnNldD11dGYtOCcpO1xuICAgIHJlcy5zZXRIZWFkZXIoJ0FjY2Vzcy1Db250cm9sLUFsbG93LU9yaWdpbicsICcqJyk7XG4gICAgcmVzLnNldEhlYWRlcignWC1BY2NlbC1CdWZmZXJpbmcnLCAnbm8nKTtcbiAgICByZXMuc2V0SGVhZGVyKCdDYWNoZS1Db250cm9sJywgJ25vLWNhY2hlLCBuby10cmFuc2Zvcm0nKTtcblxuICAgIGdldFYyKG1lc3NhZ2UsIHJlcyk7XG59Il0sIm5hbWVzIjpbIk9wZW5BaSIsInJlcXVpcmUiLCJjb25maWciLCJjbGllbnQiLCJhcGlLZXkiLCJwcm9jZXNzIiwiZW52IiwiT1BFTkFJX0FQSV9LRVkiLCJiYXNlVVJMIiwiZ2V0VjIiLCJtZXNzYWdlIiwicmVzIiwic3RyZWFtIiwiY2hhdCIsImNvbXBsZXRpb25zIiwiY3JlYXRlIiwibWVzc2FnZXMiLCJyb2xlIiwiY29udGVudCIsIm1vZGVsIiwicGFydCIsImV2ZW50TmFtZSIsImNvbnNvbGUiLCJsb2ciLCJjaG9pY2VzIiwiZGVsdGEiLCJ3cml0ZSIsImVuZCIsImVycm9yIiwicmVxIiwicXVlcnkiLCJzZXRIZWFkZXIiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api-node)/./pages/api/v2.ts\n");

/***/ }),

/***/ "dotenv":
/*!*************************!*\
  !*** external "dotenv" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("dotenv");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "openai":
/*!*************************!*\
  !*** external "openai" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("openai");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fv2&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fv2.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();